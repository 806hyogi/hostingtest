<!DOCTYPE html>
<html style="height: 100%;">

<head>
  <meta charset="UTF-8">
  <title>KaKaoMap Study</title>
  <style>
    /* GPS 버튼 스타일 */
    .gps-btn {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      width: 50px; /* adjust as needed */
      height: 50px; /* adjust as needed */
      padding: 0;
      background-color: transparent;
      border-radius: 4px;
      border:none;
      background-image:url('./src/gps.png'); 
      background-size :cover; 
      z-index :999;
    }

    .gps-btn:active {
      opacity :0.6; 
    }

    /* GPS 아이콘 스타일 */
    .gps-icon {
      display: inline-block;
      width: 15px;
      height: 15px;
      background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/location.png') no-repeat;
      background-size: 15px
    }

    #map {
      position: relative;
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body style="margin:0;padding:0;height:100%;">
  <div id="map" style="width:100%;height:100%;">
    <!--GPS버튼 -->
    <button class='gps-btn' onclick='moveToCurrentLocation()' aria-label='현재 위치'></button>
  </div>
  
  <!-- 외부 JavaScript 파일 가져오기 -->
  <script src="marker.js"></script>
  <script src="geolocation.js"></script>
  <script src="angle.js"></script>
  <script src="polyline.js"></script>

  <!-- 카카오 맵 API 연동 -->
  <script type="text/javascript"
    src="//dapi.kakao.com/v2/maps/sdk.js?appkey=baa1f48d1a2ac62f865637b2ddb9ac08&libraries=services"></script>
  <script type="text/javascript">
    var marker;
    var currentPosition;
    var lastPosition = null;

    var container = document.getElementById('map');
    var options = {
      center: new kakao.maps.LatLng(33.450701, 126.570667),
      level: 3
    };

    var map = new kakao.maps.Map(container, options);

    // 확대/축소 컨트롤을 생성합니다.
    var zoomControl = new kakao.maps.ZoomControl();
    map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

    // 현재 위치로 이동하는 함수입니다.
    function moveToCurrentLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function (position) {
          var lat = position.coords.latitude,
            lon = position.coords.longitude;
          var locPosition = new kakao.maps.LatLng(lat, lon);

          // 마커가 있다면 제거
          if (marker) {
            marker.setMap(null);
          }

          // 마커를 생성하고 지도에 표시합니다
          marker = new kakao.maps.Marker({
            map: map,
            position: locPosition
          });

          // 지도 중심을 현재 위치로 이동시킵니다
          map.setCenter(locPosition);
        });
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    }
  </script>
  
</body>

</html>